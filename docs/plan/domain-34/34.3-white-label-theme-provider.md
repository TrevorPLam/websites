### 34.3 White-Label Theme Provider

**File:** `apps/portal/src/components/providers/WhiteLabelProvider.tsx`

```typescript
import { headers } from 'next/headers';
import { resolveTenant } from '@repo/multi-tenant/resolve-tenant';
import { db } from '@repo/db';

// ============================================================================
// WHITE-LABEL THEME PROVIDER
// Server Component: reads white-label config from DB, injects CSS variables
// into <head> so the portal renders with the client's brand colors from byte 1.
// No flash of wrong brand color — values are in the SSR'd HTML.
// ============================================================================

export async function WhiteLabelProvider({
  children,
}: {
  children: React.ReactNode;
}) {
  const headersList = await headers();
  const tenantContext = await resolveTenant({ headers: headersList } as any);

  let whiteLabelConfig = null;

  if (tenantContext) {
    const { data: tenant } = await db
      .from('tenants')
      .select('config, plan')
      .eq('id', tenantContext.tenantId)
      .single();

    // White-label only available on Enterprise plan
    if (tenant?.plan === 'enterprise') {
      whiteLabelConfig = (tenant.config as any)?.whiteLabel ?? null;
    }
  }

  // If no white-label config, use agency defaults
  const primaryColor = whiteLabelConfig?.portalPrimaryColor ?? '#2563eb';
  const portalName = whiteLabelConfig?.portalName ?? process.env.NEXT_PUBLIC_AGENCY_NAME ?? 'Client Portal';

  const cssVars = `
    :root {
      --color-primary: ${primaryColor};
      --color-primary-50: ${primaryColor}14;
      --color-primary-100: ${primaryColor}29;
      --color-primary-500: ${primaryColor};
      --color-primary-600: ${primaryColor}e6;
      --color-primary-700: ${primaryColor}cc;
      --portal-name: "${portalName}";
    }
  `.trim();

  return (
    <>
      {/* Inline CSS variables — no FOUC, no flash */}
      <style
        dangerouslySetInnerHTML={{ __html: cssVars }}
        id="white-label-vars"
      />
      {children}
    </>
  );
}
```

---
