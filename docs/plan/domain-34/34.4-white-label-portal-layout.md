### 34.4 White-Label Portal Layout

**File:** `apps/portal/src/app/layout.tsx` (relevant sections)

```typescript
import { WhiteLabelProvider } from '@/components/providers/WhiteLabelProvider';
import { WhiteLabelHeader } from '@/components/layout/WhiteLabelHeader';
import { WhiteLabelFooter } from '@/components/layout/WhiteLabelFooter';

export default async function PortalLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const headersList = await headers();
  const tenantContext = await resolveTenant({ headers: headersList } as any);

  let whiteLabelData = {
    portalName: process.env.NEXT_PUBLIC_AGENCY_NAME ?? 'Client Portal',
    logoUrl: null as string | null,
    faviconUrl: null as string | null,
    hideAgencyBranding: false,
    supportEmail: process.env.NEXT_PUBLIC_AGENCY_SUPPORT_EMAIL,
    hideSupportLink: false,
  };

  if (tenantContext) {
    const { data: tenant } = await db
      .from('tenants')
      .select('config, plan')
      .eq('id', tenantContext.tenantId)
      .single();

    if (tenant?.plan === 'enterprise') {
      const wl = (tenant.config as any)?.whiteLabel;
      if (wl?.enabled) {
        whiteLabelData = {
          portalName: wl.portalName ?? whiteLabelData.portalName,
          logoUrl: wl.portalLogoUrl ?? null,
          faviconUrl: wl.portalFaviconUrl ?? null,
          hideAgencyBranding: wl.hideAgencyBranding ?? false,
          supportEmail: wl.supportEmail ?? whiteLabelData.supportEmail,
          hideSupportLink: wl.hideSupportLink ?? false,
        };
      }
    }
  }

  return (
    <html lang="en" suppressHydrationWarning>
      <head>
        {whiteLabelData.faviconUrl && (
          <link rel="icon" href={whiteLabelData.faviconUrl} />
        )}
      </head>
      <body>
        <WhiteLabelProvider>
          <WhiteLabelHeader
            portalName={whiteLabelData.portalName}
            logoUrl={whiteLabelData.logoUrl}
          />
          <main id="main-content">
            {children}
          </main>
          <WhiteLabelFooter
            hideAgencyBranding={whiteLabelData.hideAgencyBranding}
            supportEmail={whiteLabelData.supportEmail}
            hideSupportLink={whiteLabelData.hideSupportLink}
          />
        </WhiteLabelProvider>
      </body>
    </html>
  );
}
```

**File:** `apps/portal/src/components/layout/WhiteLabelHeader.tsx`

```typescript
import Image from 'next/image';
import Link from 'next/link';

interface WhiteLabelHeaderProps {
  portalName: string;
  logoUrl: string | null;
}

export function WhiteLabelHeader({ portalName, logoUrl }: WhiteLabelHeaderProps) {
  return (
    <header className="sticky top-0 z-40 bg-white border-b border-gray-200 h-16">
      <div className="h-full max-w-7xl mx-auto px-4 sm:px-6 flex items-center justify-between">
        <Link
          href="/dashboard"
          className="flex items-center gap-3 focus-visible:ring-2 focus-visible:ring-primary rounded-lg"
          aria-label={`${portalName} — go to dashboard`}
        >
          {logoUrl ? (
            <Image
              src={logoUrl}
              alt={`${portalName} logo`}
              width={120}
              height={36}
              className="h-8 w-auto object-contain"
              priority
            />
          ) : (
            <span className="text-lg font-bold text-gray-900">{portalName}</span>
          )}
        </Link>

        {/* Navigation, notifications, user menu — same regardless of white-label */}
        <PortalHeaderActions />
      </div>
    </header>
  );
}

function PortalHeaderActions() {
  // Notifications bell, user avatar dropdown — implementation shared across all tenants
  return (
    <div className="flex items-center gap-3">
      {/* See Domain 3 (Auth) for user menu implementation */}
    </div>
  );
}
```

**File:** `apps/portal/src/components/layout/WhiteLabelFooter.tsx`

```typescript
interface WhiteLabelFooterProps {
  hideAgencyBranding: boolean;
  supportEmail?: string;
  hideSupportLink: boolean;
}

export function WhiteLabelFooter({
  hideAgencyBranding,
  supportEmail,
  hideSupportLink,
}: WhiteLabelFooterProps) {
  return (
    <footer className="border-t border-gray-100 py-4 px-6 mt-auto">
      <div className="max-w-7xl mx-auto flex items-center justify-between text-xs text-gray-400">
        <p>© {new Date().getFullYear()} All rights reserved.</p>

        <div className="flex items-center gap-4">
          {supportEmail && !hideSupportLink && (
            <a href={`mailto:${supportEmail}`} className="hover:text-gray-600 transition-colors">
              Support
            </a>
          )}

          {/* "Powered by" — hidden on Enterprise white-label */}
          {!hideAgencyBranding && (
            <span className="text-gray-300">
              Powered by {process.env.NEXT_PUBLIC_AGENCY_NAME ?? 'Platform'}
            </span>
          )}
        </div>
      </div>
    </footer>
  );
}
```

---
