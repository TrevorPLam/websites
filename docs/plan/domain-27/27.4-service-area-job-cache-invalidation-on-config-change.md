### 27.4 Service Area Job: Cache Invalidation on Config Change

When the client updates their service areas via the portal, the relevant service area page caches must be busted. This is done via a tag-based `revalidateTag` call.

**File:** `packages/cache/src/invalidate-tenant.ts`

```typescript
import { revalidateTag } from 'next/cache';

export async function invalidateTenantServiceAreas(
  tenantId: string,
  changedSlugs?: string[]
): Promise<void> {
  if (changedSlugs?.length) {
    // Bust only the changed areas
    for (const slug of changedSlugs) {
      revalidateTag(`tenant:${tenantId}:service-area:${slug}`);
    }
  } else {
    // Bust all service area pages for this tenant
    revalidateTag(`tenant:${tenantId}:service-area`);
  }

  // Also bust the sitemap (now includes new/removed areas)
  revalidateTag(`tenant:${tenantId}:sitemap`);
}
```

---
