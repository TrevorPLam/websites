### 15.1 Philosophy

**What it is:** Security is a system property — not a single file. The platform hardens at four layers: HTTP headers (what the browser enforces), rate limiting (what the edge enforces), input sanitization (what the application enforces), and secrets management (what the infrastructure enforces). [github](https://github.com/vercel/next.js/discussions/80997)

**CVE-2025-29927 lesson:** The March 2025 Next.js middleware bypass vulnerability allowed attackers to skip all middleware by sending a crafted `x-middleware-subrequest` header — bypassing auth, CSP, and rate limiting simultaneously. The lesson: **never rely solely on middleware for access control**. Route Handlers and Server Actions must independently verify session/permissions. Defense in depth is not optional. [projectdiscovery](https://projectdiscovery.io/blog/nextjs-middleware-authorization-bypass)

---
