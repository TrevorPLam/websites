### 3.8 Root AGENTS.md (Master)

**File:** `AGENTS.md` (root of monorepo)

**Critical Constraint:** <60 lines (to fit in AI agent context window efficiently)

````markdown
# Marketing Monorepo — AI Agent Master Context

## Overview

Multi-tenant, multi-site Next.js 16 marketing platform. 1-1,000 client sites from single codebase.

**Stack:** Next.js 16, React 19, Tailwind v4, Supabase, Turborepo 2.7, pnpm 10.x, FSD v2.1

## Quick Start

```bash
pnpm install            # Install dependencies
pnpm dev                # Start all dev servers
pnpm build              # Build all packages
pnpm test               # Run all tests
```
````

## Repository Structure

- `apps/admin/` — Internal admin dashboard
- `apps/portal/` — Client white-label portal
- `sites/*/` — Client marketing sites (1-1,000+)
- `packages/*/` — Shared libraries (15+ packages)
- `e2e/` — End-to-end tests (Playwright)
- `docs/` — Documentation + runbooks

## Key Files

- `pnpm-workspace.yaml` — Workspace + catalog config
- `turbo.jsonc` — Task orchestration
- `sites/*/site.config.ts` — Single source of truth for each client
- `CLAUDE.md` — Sub-agent definitions

## FSD Architecture (Feature-Sliced Design v2.1)

All packages use FSD layers: `app → pages → widgets → features → entities → shared`
Cross-slice imports via `@x` notation (linted by Steiger).

## Configuration-as-Code

Every client site defined by `site.config.ts` (Zod-validated). Change config → re-deploy.

## Multi-Tenancy

Tenant resolved via middleware (subdomain/path/custom domain). See `packages/multi-tenant/`.

## Security

- Server Actions wrapped with `createServerAction()` (CVE-2025-29927 mitigation)
- Supabase RLS on all tables (see `packages/db/src/migrations/`)
- Rate limiting via Upstash (per-tenant tiers)

## Observability

- OpenTelemetry (spans tagged with `tenantId`)
- Sentry (multi-tenant error tagging)
- Tinybird (Core Web Vitals per tenant)

## Compliance

- WCAG 2.2 AA target (April 2026 deadline)
- GDPR: DPA templates in `packages/org-assets/legal/`
- NIST PQC: `packages/crypto-provider/` (RSA → Hybrid → ML-DSA migration)

## Package Details

See per-package `AGENTS.md` in each `packages/*/` directory.

## Common Workflows

- New client site: `pnpm tsx scripts/create-site.ts`
- Build single site: `pnpm build --filter=sterling-law`
- Run E2E tests: `pnpm test:e2e`
- Validate configs: `pnpm turbo run validate:configs`

## AI Agent Resources

- `CLAUDE.md` — Claude Code sub-agent definitions
- `docs/architecture/` — System diagrams
- `docs/runbooks/` — Step-by-step guides

Last Updated: 2026-02-23

```

**Why <60 lines:** AI agents have limited context windows. Master `AGENTS.md` must fit alongside code snippets.

**When to Build:** P0 (All 15+ AGENTS.md files created during initial setup)
```
