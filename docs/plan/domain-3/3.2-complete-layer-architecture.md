### 3.2 Complete Layer Architecture

**FSD Layers (Top → Bottom, Unidirectional Dependencies):**

```
┌─────────────────────────────────────┐
│ app (Application Layer)             │  ← Can import: pages, widgets, features, entities, shared
│ - Providers, Routing, Global Styles │
└─────────────────────────────────────┘
            ↓ (can import)
┌─────────────────────────────────────┐
│ pages (Page Layer)                  │  ← Can import: widgets, features, entities, shared
│ - Route-level components            │
└─────────────────────────────────────┘
            ↓ (can import)
┌─────────────────────────────────────┐
│ widgets (Composite Layer)           │  ← Can import: features, entities, shared
│ - Large UI compositions             │
└─────────────────────────────────────┘
            ↓ (can import)
┌─────────────────────────────────────┐
│ features (Business Logic Layer)     │  ← Can import: entities, shared
│ - User interactions, actions        │  ← Can import other features via @x
└─────────────────────────────────────┘
            ↓ (can import)
┌─────────────────────────────────────┐
│ entities (Domain Layer)             │  ← Can import: shared
│ - Business entities (User, Lead)    │  ← Can import other entities via @x
└─────────────────────────────────────┘
            ↓ (can import)
┌─────────────────────────────────────┐
│ shared (Infrastructure Layer)       │  ← Can import: nothing (pure utilities)
│ - UI kit, utils, config, API client│
└─────────────────────────────────────┘
```

**Dependency Rules:**

- Unidirectional: Lower layers cannot import from upper layers
- Same-layer imports prohibited: `features/a` cannot import from `features/b`
- Cross-slice imports: Use `@x` notation (controlled violation)

**Key Rules:**

- Lower layers cannot import higher layers (e.g., `entities` cannot import `features`)
- Same-layer imports via `@x` notation (controlled cross-slice imports)
- Public API via `index.ts` (only exported items are accessible)

**Example Valid Import:**

```typescript
// ✅ VALID: feature imports from entity
// packages/ui/src/features/lead-form/ui/ContactForm.tsx

import { Lead } from '@/entities/lead'; // ✅ Lower layer
import { Button } from '@/shared/ui'; // ✅ Lower layer
```

**Example Invalid Import:**

```typescript
// ❌ INVALID: feature imports from another feature
// packages/ui/src/features/lead-form/ui/ContactForm.tsx

import { useABTest } from '@/features/a-b-test'; // ❌ Same layer (prohibited)
```

**Example Cross-Slice Import (Controlled Violation):**

```typescript
// ⚠️ CONTROLLED: entity imports from entity via @x notation
// packages/ui/src/entities/order/model/order.ts

import { User } from '@/entities/user/@x'; // ⚠️ Cross-slice (explicit, linted)
```

**When to Build:** P0 (Foundation for all packages)

## Implementation Status

- Status: ✅ Complete
- QA: ✅ Completed
- Related files:
  - `docs/architecture/domain-3-fsd-layer-architecture.md`
  - `packages/AGENTS.md`
