### 4.1 Philosophy

**What it is:** A layered security model where each layer independently rejects unauthorized requests. No single point of failure. Middleware rejects before the route runs; the Server Action wrapper rejects before business logic executes; RLS rejects at the database before any row is returned. [pentest-tools](https://pentest-tools.com/blog/cve-2025-29927-next-js-bypass)

**Why it matters:** CVE-2025-29927 (March 2025) proved that middleware-only security is a single point of failure — a crafted `x-middleware-subrequest` header let attackers bypass all middleware checks in every unpatched Next.js version below 15.2.3/14.2.25. For a multi-tenant platform, a single bypass exposes every client's data simultaneously. [securitylabs.datadoghq](https://securitylabs.datadoghq.com/articles/nextjs-middleware-auth-bypass/)

**Defense model:**

```

Request → [Edge: Strip malicious headers] → [Middleware: Auth + CSP + Rate limit]
→ [Server Action Wrapper: Zod + Auth re-verify + IDOR check]
→ [Supabase RLS: Row-level tenant isolation]
→ [Audit Log: Every mutation recorded]

```

**When to build:** **P0 (Week 1)** — All four layers before first line of business logic.

---
