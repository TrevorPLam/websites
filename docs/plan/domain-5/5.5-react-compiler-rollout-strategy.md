### 5.5 React Compiler Rollout Strategy

**Three-phase rollout to avoid breaking existing components:** [nextjs](https://nextjs.org/docs/app/api-reference/config/next-config-js/reactCompiler)

**Phase 1 (P0 — Opt-in annotation mode):**

```typescript
// next.config.ts
reactCompiler: {
  compilationMode: 'annotation', // Only compile components marked with 'use memo'
}
```

```typescript
// Opt specific component into React Compiler optimization
'use memo'; // Add this directive to component file

export function ServiceCard({ title, description, icon }: ServiceCardProps) {
  // React Compiler will automatically optimize this component
  // No manual useMemo/useCallback needed
  return (
    <div className="p-6 rounded-lg border">
      <h3>{title}</h3>
      <p>{description}</p>
    </div>
  );
}
```

**Phase 2 (P1 — Lint audit):**

```bash
# Identify components that would benefit from React Compiler
npx react-compiler-healthcheck --stats

# Output:
# Successfully compiled: 143 out of 162 components
# Issues found: 19 components (manual intervention needed)
```

**Phase 3 (P2 — Global enable):**

```typescript
// next.config.ts (after fixing all 19 issues)
reactCompiler: true, // Global enable
```

**Common issues that block React Compiler:**

- Mutating props directly (fix: use immer or spread)
- Non-pure render functions (fix: extract side effects to useEffect)
- Accessing `window` at render time (fix: useEffect or dynamic import)

---
