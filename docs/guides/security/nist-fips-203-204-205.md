<!--
/**
 * @file nist-fips-203-204-205.md
 * @role Technical Documentation Guide
 * @summary Documentation and implementation guide for nist fips 203 204 205.
 * @entrypoints docs/guides/nist-fips-203-204-205.md
 * @exports nist fips 203 204 205
 * @depends_on [List dependencies here]
 * @used_by [List consumers here]
 * @runtime Multi-agent / Node.js 20+
 * @data_flow Documentation -> Agentic Context
 * @invariants Standard Markdown format, 2026 technical writing standards
 * @gotchas Missing references in some legacy versions
 * @issues Needs TOC and Reference section standardization
 * @opportunities Automate with multi-agent refinement loop
 * @verification validate-documentation.js
 * @status DRAFT
 */
-->

# nist-fips-203-204-205.md

## Table of Contents

- [Overview](#overview)
- [Implementation](#implementation)
- [Best Practices](#best-practices)
- [Testing](#testing)
- [References](#references)


## Overview

NIST Federal Information Processing Standards (FIPS) 203, 204, and 205 represent the first standardized post-quantum cryptographic algorithms approved by the U.S. government. Published in August 2024, these standards formalize ML-KEM (Module-Lattice-Based Key Encapsulation Mechanism), ML-DSA (Module-Lattice-Based Digital Signature Algorithm), and SLH-DSA (Stateless Hash-Based Digital Signature Algorithm) as the foundation for quantum-resistant cryptography.

## Publication Details

### FIPS 203: Module-Lattice-Based Key Encapsulation Mechanism Standard

**Publication Date:** August 13, 2024  
**Document Number:** NIST FIPS 203  
**Former Name:** CRYSTALS-Kyber  
**Purpose:** Key establishment for secure communication channels

### FIPS 204: Module-Lattice-Based Digital Signature Standard

**Publication Date:** August 13, 2024  
**Document Number:** NIST FIPS 204  
**Former Name:** CRYSTALS-Dilithium  
**Purpose:** Digital signatures for authentication and integrity

### FIPS 205: Stateless Hash-Based Digital Signature Standard

**Publication Date:** August 13, 2024  
**Document Number:** NIST FIPS 205  
**Former Name:** SPHINCS+  
**Purpose:** Conservative digital signatures based on hash functions

## Algorithm Specifications

### ML-KEM (FIPS 203)

#### Security Categories

- **ML-KEM-512**: Category 1 security (~AES-128)
- **ML-KEM-768**: Category 3 security (~AES-192)
- **ML-KEM-1024**: Category 5 security (~AES-256)

#### Key Sizes and Performance

| Parameter Set | Public Key Size | Ciphertext Size | Secret Key Size | Security Level |
| ------------- | --------------- | --------------- | --------------- | -------------- |
| ML-KEM-512    | 800 bytes       | 768 bytes       | 1,632 bytes     | Category 1     |
| ML-KEM-768    | 1,184 bytes     | 1,088 bytes     | 2,400 bytes     | Category 3     |
| ML-KEM-1024   | 1,568 bytes     | 1,568 bytes     | 3,200 bytes     | Category 5     |

#### Core Operations

```typescript
// ML-KEM Key Generation
function ML_KEM_KeyGen(seed?: Uint8Array): {
  publicKey: Uint8Array;
  secretKey: Uint8Array;
};

// ML-KEM Encapsulation
function ML_KEM_Encapsulate(publicKey: Uint8Array): {
  ciphertext: Uint8Array;
  sharedSecret: Uint8Array;
};

// ML-KEM Decapsulation
function ML_KEM_Decapsulate(ciphertext: Uint8Array, secretKey: Uint8Array): Uint8Array;
```

### ML-DSA (FIPS 204)

#### Security Categories

- **ML-DSA-44**: Category 1 security (~AES-128)
- **ML-DSA-65**: Category 3 security (~AES-192)
- **ML-DSA-87**: Category 5 security (~AES-256)

#### Key Sizes and Performance

| Parameter Set | Public Key Size | Private Key Size | Signature Size | Security Level |
| ------------- | --------------- | ---------------- | -------------- | -------------- |
| ML-DSA-44     | 1,312 bytes     | 2,560 bytes      | 2,420 bytes    | Category 1     |
| ML-DSA-65     | 1,952 bytes     | 4,000 bytes      | 3,309 bytes    | Category 3     |
| ML-DSA-87     | 2,592 bytes     | 4,896 bytes      | 4,595 bytes    | Category 5     |

#### Core Operations

```typescript
// ML-DSA Key Generation
function ML_DSA_KeyGen(seed?: Uint8Array): {
  publicKey: Uint8Array;
  privateKey: Uint8Array;
};

// ML-DSA Signing
function ML_DSA_Sign(message: Uint8Array, privateKey: Uint8Array): Uint8Array;

// ML-DSA Verification
function ML_DSA_Verify(message: Uint8Array, signature: Uint8Array, publicKey: Uint8Array): boolean;
```

### SLH-DSA (FIPS 205)

#### Algorithm Variants

**Hash Function Options:**

- SHA-2 family (SHA-256, SHA-384, SHA-512)
- SHA-3 family (SHAKE-128, SHAKE-256)

**Security/Performance Trade-offs:**

- **Small (s)**: Smaller signatures, slower verification
- **Fast (f)**: Larger signatures, faster verification

#### Parameter Sets

| Hash Function | Security Level | Size Variant | Public Key Size | Signature Size |
| ------------- | -------------- | ------------ | --------------- | -------------- |
| SHA-256       | 128            | s            | 32 bytes        | 7,856 bytes    |
| SHA-256       | 128            | f            | 32 bytes        | 17,664 bytes   |
| SHA-512       | 256            | s            | 64 bytes        | 16,320 bytes   |
| SHA-512       | 256            | f            | 64 bytes        | 29,504 bytes   |

## Changes from Draft to Final Standards

Based on PQShield analysis and NIST documentation, several key improvements were made:

### FIPS 203 ML-KEM Changes

1. **Domain Separation in K-PKE.KeyGen**
   - Prevents misuse of keys across different security levels
   - Adds cryptographic separation between parameter sets

2. **Matrix Index Fix**
   - Corrected switched indices in K-PKE.KeyGen and K-PKE-Encrypt
   - Restored to match original CRYSTALS-Kyber submission

### FIPS 204 ML-DSA Changes

1. **Malformed Input Check Restoration**
   - Reinstated input validation in Algorithm 21 (hint unpacking)
   - Improves robustness against malformed inputs

2. **Domain Separation for Message Signing**
   - Added separation for direct message vs. digest signing
   - Prevents cross-protocol attacks

3. **Parameter Set Domain Separation**
   - Added in Algorithm 6 to prevent parameter set expansion attacks
   - Ensures different parameter sets cannot be derived from same seed

### FIPS 205 SLH-DSA Changes

1. **Domain Separation for Message Signing**
   - Consistent with ML-DSA approach
   - Separates direct message signing from digest signing

## Security Requirements

### Minimum Security Levels

**NIST Recommendations:**

- **Category 3+**: Recommended for most applications
- **Category 5**: Required for national security systems
- **Category 1**: Minimum acceptable for legacy migration

**Regional Requirements:**

- **United States**: Category 3+ for federal systems, Category 5 for national security
- **Australia**: Category 5 only after 2030
- **European Union**: Category 3 recommended with sector-specific variations

### Implementation Requirements

#### Compliance Standards

1. **Constant-Time Implementation**
   - All operations must be constant-time
   - No data-dependent branches or memory accesses

2. **Side-Channel Resistance**
   - Resistance to timing attacks
   - Resistance to power analysis attacks
   - Resistance to electromagnetic emissions

3. **Random Number Generation**
   - Use approved CSPRNGs
   - Seed material must be unpredictable
   - Entropy sources must be validated

#### Validation Requirements

1. **Algorithm Testing**
   - Known-answer tests (KATs)
   - Monte Carlo tests
   - Functional testing

2. **Performance Benchmarks**
   - Minimum performance requirements
   - Memory usage limits
   - Power consumption constraints

## Implementation Guidelines

### Cryptographic Library Integration

#### Recommended Libraries

**Open Source:**

- **OpenSSL 3.2+**: Built-in PQC algorithm support
- **BoringSSL**: Google's PQC implementation
- **liboqs**: Open Quantum Safe project library
- **@noble/post-quantum**: JavaScript/TypeScript implementation

**Commercial:**

- **PQShield**: Hardware and software solutions
- **Crypto4A**: FIPS-validated implementations
- **Microsoft Quantum-Resistant**: Windows and Azure integration

#### Integration Patterns

```typescript
// Algorithm-agnostic interface
interface PostQuantumKEM {
  keygen(seed?: Uint8Array): { publicKey: Uint8Array; secretKey: Uint8Array };
  encapsulate(publicKey: Uint8Array): { ciphertext: Uint8Array; sharedSecret: Uint8Array };
  decapsulate(ciphertext: Uint8Array, secretKey: Uint8Array): Uint8Array;
}

interface PostQuantumSignature {
  keygen(seed?: Uint8Array): { publicKey: Uint8Array; privateKey: Uint8Array };
  sign(message: Uint8Array, privateKey: Uint8Array): Uint8Array;
  verify(message: Uint8Array, signature: Uint8Array, publicKey: Uint8Array): boolean;
}
```

### Hybrid Cryptography Support

#### NIST Hybrid Recommendations

**Permitted Hybrid Schemes:**

- **Key Exchange**: ML-KEM + X25519 (XWing standard)
- **Digital Signatures**: ML-DSA with classical fallback (not yet standardized)

**Implementation Example:**

```typescript
// Hybrid Key Exchange (XWing)
function HybridKeyExchange(recipientPublicKey: Uint8Array): {
  // Classical component
  const classicalShared = X25519(recipientPublicKey.classical, privateKey.classical);

  // Post-quantum component
  const pqcShared = ML_KEM_Encapsulate(recipientPublicKey.pqc);

  // Combine with KDF
  return HKDF(
    Buffer.concat([classicalShared, pqcShared.sharedSecret]),
    'Hybrid Key Exchange',
    32
  );
}
```

## Migration and Deployment

### Migration Timeline

#### 2024-2026: Standardization and Early Adoption

- **Q3 2024**: FIPS standards publication
- **Q4 2024**: Library implementations available
- **2025**: Pilot deployments and testing
- **2026**: First regulatory mandates

#### 2027-2030: Hybrid Deployment Phase

- **2027-2028**: Hybrid cryptography deployment
- **2029**: Pure PQC for new systems
- **2030**: Australian ASD deadline for Category 5

#### 2031-2035: Full PQC Migration

- **2031-2033**: Legacy system replacement
- **2034**: Classical cryptography deprecation
- **2035**: US government CNSA 2.0 compliance deadline

### Deployment Considerations

#### Performance Impact

**Expected Overhead:**

- **Key Generation**: 10-100x slower than classical
- **Encryption/Decryption**: 2-10x overhead
- **Signature Operations**: 5-50x slower
- **Key Sizes**: 2-10x larger than classical keys

**Mitigation Strategies:**

- Hardware acceleration (ASICs, FPGAs)
- Algorithm optimization and caching
- Load balancing and distributed processing
- Selective PQC deployment based on risk assessment

#### Compatibility Requirements

**Protocol Integration:**

- TLS 1.3 with PQC cipher suites
- IKEv2 with post-quantum key exchange
- S/MIME with PQC signatures
- Code signing with PQC algorithms

**System Integration:**

- PKI infrastructure updates
- Certificate format changes
- Hardware security module (HSM) support
- Key management system (KMS) integration

## Testing and Validation

### Compliance Testing

#### Algorithm Validation

**Test Vectors:**

- Known-answer tests for all parameter sets
- Monte Carlo tests for statistical validation
- Interoperability tests between implementations

**Performance Testing:**

- Benchmarking against NIST requirements
- Resource utilization monitoring
- Scalability testing for high-volume applications

#### Security Testing

**Side-Channel Testing:**

- Timing analysis
- Power analysis
- Electromagnetic emission testing
- Cache timing attacks

**Implementation Testing:**

- Fuzz testing for robustness
- Penetration testing with quantum-resistant algorithms
- Cryptographic protocol testing

### Certification Requirements

#### FIPS Validation

**Validation Process:**

- Laboratory testing by accredited labs
- Documentation review
- Source code analysis
- Hardware/firmware validation

**Ongoing Requirements:**

- Annual re-validation
- Change control procedures
- Security patch management
- Vulnerability disclosure process

## References

- [Research Inventory](../../tasks/RESEARCH-INVENTORY.md) â€” Internal patterns

### Official Standards Documents

- [FIPS 203: Module-Lattice-Based Key Encapsulation Mechanism Standard](https://nvlpubs.nist.gov/nistpubs/fips/nist.fips.203.pdf)
- [FIPS 204: Module-Lattice-Based Digital Signature Standard](https://nvlpubs.nist.gov/nistpubs/fips/nist.fips.204.pdf)
- [FIPS 205: Stateless Hash-Based Digital Signature Standard](https://nvlpubs.nist.gov/nistpubs/fips/nist.fips.205.pdf)
- [Federal Register Announcement](https://www.federalregister.gov/documents/2024/08/14/2024-17956/announcing-issuance-of-federal-information-processing-standards-fips-fips-203-module-lattice-based)

### Technical Analysis

- [PQShield: New PQC Standards Analysis](https://pqshield.com/new-pqc-standards-whats-changed-since-the-draft-versions/)
- [NIST Post-Quantum Cryptography Project](https://csrc.nist.gov/projects/post-quantum-cryptography)
- [Open Quantum Safe Project](https://openquantumsafe.org/)

### Implementation Resources

- [OpenSSL 3.2+ Documentation](https://www.openssl.org/docs/)
- [liboqs Implementation Guide](https://github.com/open-quantum-safe/liboqs)
- [@noble/post-quantum JavaScript Library](https://github.com/paulmillr/noble-post-quantum)

### Migration Guidance

- [NIST IR 8547: Transition to Post-Quantum Cryptography](https://csrc.nist.gov/pubs/ir/8547/ipd)
- [NSA CNSA 2.0 Suite](https://www.nsa.gov/Cybersecurity/NSA-is-Transitioning-to-Quantum-Resistant-Algorithms/)
- [Australian ASD Cryptography Guidelines](https://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/ism/cyber-security-guidelines/guidelines-cryptography)


## Best Practices

[Add content here]
